"use strict";(self.webpackChunkgoit_react_hw_08_phonebook=self.webpackChunkgoit_react_hw_08_phonebook||[]).push([[285],{285:function(e,n,r){r.r(n),r.d(n,{default:function(){return V}});var t=r(5048),a=r(1614),i=r(9658),o=r(7317),c=r(890),s=r(9953),l=r(9877),d=r(2419),u=r(5193),h=r(1413),m=r(9439),x=r(2791),v=r(4554),Z=r(3044),f=r(3239),j=r(7665),p=r(4518),b=r(8535),g=r(1286),w=r(8518),y=r(6727),C=r(6546),k=r(6351),L=r(7748),A=r(3329);function _(){var e=(0,t.v9)(k.tU),n=(0,t.v9)(k.rn),r=(0,x.useState)({name:!0,number:!0}),i=(0,m.Z)(r,2),o=i[0],c=i[1],s=(0,L.Jx)().data,l=(0,L.Tn)(),d=(0,m.Z)(l,2),u=d[0],_=d[1].isLoading,S=(0,L.i)(),P=(0,m.Z)(S,2),D=P[0],I=P[1].isLoading,W=_||I,z=(0,t.I0)(),F=e==="new",N=e==="edit",T=function(e){return s.find((function(n){return n.id===e}))},E=(0,x.useRef)(N?T(n):null),J=(0,x.useState)(n?T(n).name:""),$=(0,m.Z)(J,2),q=$[0],M=$[1],R=(0,x.useState)(n?T(n).number:""),Y=(0,m.Z)(R,2),B=Y[0],G=Y[1],K=(0,y.Z_)().matches(/^[a-zA-Z\u0430-\u044f\u0456\u0457\u0454\u0491\u0410-\u042f\u0406\u0407\u0404\u0490]+([' -][a-zA-Z\u0430-\u044f\u0456\u0457\u0454\u0491\u0410-\u042f\u0406\u0407\u0404\u0490]*)*$/).max(35),U=(0,y.Z_)().matches(/\+?\d{1,4}?[-.\s]?\(?\d{1,3}?\)?[-.\s]?\d{1,4}[-.\s]?\d{1,4}[-.\s]?\d{1,9}/).max(20),V=function(e){var n=e.currentTarget,r=n.name,t=n.value;switch(r){case"name":K.validate(t).then((function(){return c((function(e){return(0,h.Z)((0,h.Z)({},e),{},{name:!0})}))})).catch((function(){return c((function(e){return(0,h.Z)((0,h.Z)({},e),{},{name:!1})}))})),M(t);break;case"number":U.validate(t).then((function(){return c((function(e){return(0,h.Z)((0,h.Z)({},e),{},{number:!0})}))})).catch((function(){return c((function(e){return(0,h.Z)((0,h.Z)({},e),{},{number:!1})}))})),G(t);break;default:throw new Error("unsupported input name")}};return(0,A.jsx)(a.Z,{maxWidth:"xs",sx:{my:4},children:(0,A.jsxs)(v.Z,{sx:{display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,A.jsx)(Z.Z,{sx:{m:1,bgcolor:"secondary.main"},children:W?(0,A.jsx)(f.Z,{size:24,color:"inherit"}):N?(0,A.jsx)(g.Z,{}):(0,A.jsx)(b.Z,{})}),(0,A.jsxs)(v.Z,{sx:{textAlign:"center"},component:"form",onSubmit:function(e){var r,t;e.preventDefault();var a=e.currentTarget.elements,i=a.name.value,c=a.number.value;if(o.name)if(o.number){var l=s.some((function(e){return e.name.toLowerCase()===i.toLowerCase()})),d=(null===E||void 0===E||null===(r=E.current)||void 0===r||null===(t=r.name)||void 0===t?void 0:t.toLowerCase())===i.toLowerCase();!l||d?(F&&u({name:i,number:c}).then((function(e){var n=e.data;z((0,C.dL)()),(0,w.yv)("Contact ".concat(n.name," added"),{variant:"success"})})).catch((function(){return(0,w.yv)("Something went wrong",{variant:"error"})})),N&&D([n,{name:i,number:c}]).then((function(e){var n=e.data;z((0,C.dL)()),(0,w.yv)("Contact ".concat(n.name," edited"),{variant:"success"})})).catch((function(){return(0,w.yv)("Something went wrong",{variant:"error"})}))):(0,w.yv)("".concat(i," is already in contacts"),{variant:"warning"})}else(0,w.yv)("Please enter the correct number",{variant:"error"});else(0,w.yv)("Please enter the correct name",{variant:"error"})},children:[(0,A.jsx)(j.Z,{fullWidth:!0,margin:"normal",label:"Name",type:"text",name:"name",value:q,error:!o.name,title:"Name may contain only letters, apostrophe, dash and spaces. For example Adrian, Jacob Mercer, Charles de Batz de Castelmore d'Artagnan",required:!0,autoFocus:!0,onChange:V}),(0,A.jsx)(j.Z,{fullWidth:!0,margin:"normal",label:"Number",type:"tel",name:"number",value:B,error:!o.number,title:"Phone number must be digits and can contain spaces, dashes, parentheses and can start with +",required:!0,onChange:V}),(0,A.jsx)(p.Z,{type:"submit",fullWidth:!0,variant:"contained",sx:{mt:3,mb:2},disabled:W,children:F?"Add new contact":"Save contact"})]})," ",(0,A.jsx)(p.Z,{type:"button",fullWidth:!0,variant:"outlined",sx:{mb:2},onClick:function(){return z((0,C.dL)())},children:"Cancel"})]})})}var S=r(493),P=r(5021),D=r(3768),I=r(3400),W=r(6278),z=r(653),F=r(9900),N=r(8619),T=r(7247);function E(e){var n=e.name,r=e.number,a=e.id,i=(0,L.Nt)(),o=(0,m.Z)(i,2),c=o[0],s=o[1].isLoading,l=(0,t.I0)();return(0,A.jsx)(P.ZP,{sx:{pr:"96px",pl:0},secondaryAction:(0,A.jsxs)(v.Z,{sx:{display:"flex",gap:"10px"},children:[(0,A.jsx)(D.Z,{title:"Edit",children:(0,A.jsx)(I.Z,{"aria-label":"edit",onClick:function(){return l((0,C.$8)(a))},children:(0,A.jsx)(g.Z,{})})}),(0,A.jsx)(D.Z,{title:"Delete",children:(0,A.jsx)(I.Z,{edge:"end","aria-label":"delete",disabled:s,onClick:function(){return c(a).then((function(e){var n=e.data;(0,w.yv)("Contact ".concat(n.name," deleted"),{variant:"info"})})).catch((function(){return(0,w.yv)("Something went wrong",{variant:"error"})}))},children:s?(0,A.jsx)(f.Z,{size:24}):(0,A.jsx)(T.Z,{})})})]}),children:(0,A.jsxs)(W.Z,{href:"tel:".concat(r),sx:{p:0},children:[(0,A.jsx)(z.Z,{children:(0,A.jsx)(Z.Z,{children:(0,A.jsx)(N.Z,{})})}),(0,A.jsx)(F.Z,{primary:"".concat(n),secondary:"".concat(r)})]})})}function J(){var e=(0,L.Jx)().data,n=void 0===e?[]:e,r=(0,t.v9)(k.AD),a=n.filter((function(e){return e.name.toLowerCase().includes(r)}));return(0,A.jsx)(S.Z,{children:a.map((function(e){return(0,A.jsx)(E,(0,h.Z)({},e),e.id)}))})}var $=r(6895);function q(){var e=(0,t.v9)(k.AD),n=(0,t.I0)();return(0,A.jsx)(j.Z,{fullWidth:!0,id:"standard-controlled",label:"Find contacts by name",variant:"standard",value:e,onChange:function(e){var r=e.currentTarget.value;n((0,$.T)(r.toLowerCase()))}})}var M=r(4321),R=r(5289),Y=r(7123),B=r(9157),G=r(1691),K=r(5661);function U(){var e=(0,t.v9)(k.R_),n=(0,t.I0)();return(0,A.jsxs)(R.Z,{open:e,onClose:function(){return n((0,C.gk)())},"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[(0,A.jsx)(K.Z,{id:"alert-dialog-title",children:"Are you sure?"}),(0,A.jsx)(B.Z,{children:(0,A.jsx)(G.Z,{id:"alert-dialog-description",children:"\u0421losing the window will delete unsaved data"})}),(0,A.jsxs)(Y.Z,{children:[(0,A.jsx)(p.Z,{onClick:function(){return n((0,C.gk)())},children:"No"}),(0,A.jsx)(p.Z,{onClick:function(){n((0,C.gk)()),n((0,C.dL)())},autoFocus:!0,children:"Yes"})]})]})}function V(){var e=(0,t.v9)(k.Vc),n=(0,t.I0)(),r=(0,L.Jx)(),h=r.data,m=void 0===h?[]:h,x=r.isError,v=r.isLoading,Z=(0,u.Z)("(max-width:786px)");return(0,A.jsxs)(a.Z,{component:"main",children:[v&&(0,A.jsx)(M.Z,{}),x&&(0,A.jsxs)(i.Z,{severity:"error",children:[(0,A.jsx)(o.Z,{children:"Error"}),"Something went wrong. Please reload the page"]}),v||x||0!==m.length?!v&&!x&&(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)(c.Z,{align:"center",component:"h1",variant:"h4",children:"Contacts"}),(0,A.jsx)(q,{}),(0,A.jsx)(J,{})]}):(0,A.jsx)(c.Z,{sx:{mt:4},align:"center",variant:"h5",paragraph:!0,children:"Your phone book is empty. Please click the button in the lower right corner and add new contacts."}),(0,A.jsx)(s.ZP,{anchor:Z?"top":"bottom",open:e,ModalProps:{onClose:function(e,r){n("escapeKeyDown"!==r&&"backdropClick"!==r?(0,C.dL)():(0,C.G3)())}},children:(0,A.jsx)(_,{})}),(0,A.jsx)(l.Z,{sx:{position:"fixed",bottom:16,right:16},color:"primary","aria-label":"add",onClick:function(){return n((0,C.$A)())},children:(0,A.jsx)(d.Z,{})}),(0,A.jsx)(U,{})]})}}}]);
//# sourceMappingURL=285.0cc33ca7.chunk.js.map